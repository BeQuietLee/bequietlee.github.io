<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Android Performance Patterns - s5ep4 Good AsyncTask Hunting | One Step, One Punch</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="本节介绍AsyncTask的使用方法与风险link">
<meta property="og:type" content="article">
<meta property="og:title" content="Android Performance Patterns - s5ep4 Good AsyncTask Hunting">
<meta property="og:url" content="http://lilei.work/2016/02/23/Android-Performance-Patterns-s5ep4-Good-AsyncTask-Hunting/index.html">
<meta property="og:site_name" content="One Step, One Punch">
<meta property="og:description" content="本节介绍AsyncTask的使用方法与风险link">
<meta property="og:image" content="http://lilei.work/img/160223_app_s5ep4/worker_thread.png">
<meta property="og:image" content="http://lilei.work/img/160223_app_s5ep4/async_task_func.png">
<meta property="og:image" content="http://lilei.work/img/160223_app_s5ep4/serial.png">
<meta property="og:image" content="http://lilei.work/img/160223_app_s5ep4/execute_on_executor.png">
<meta property="og:image" content="http://lilei.work/img/160223_app_s5ep4/on_cancel.png">
<meta property="og:updated_time" content="2016-06-29T06:23:12.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Android Performance Patterns - s5ep4 Good AsyncTask Hunting">
<meta name="twitter:description" content="本节介绍AsyncTask的使用方法与风险link">
<meta name="twitter:image" content="http://lilei.work/img/160223_app_s5ep4/worker_thread.png">
  
    <link rel="alternative" href="/atom.xml" title="One Step, One Punch" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/css/style.css">
  

</head>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">One Step, One Punch</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">bequietlee#gmail.com</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://lilei.work"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-Android-Performance-Patterns-s5ep4-Good-AsyncTask-Hunting" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/02/23/Android-Performance-Patterns-s5ep4-Good-AsyncTask-Hunting/" class="article-date">
  <time datetime="2016-02-23T13:51:03.000Z" itemprop="datePublished">2016-02-23</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Android Performance Patterns - s5ep4 Good AsyncTask Hunting
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>本节介绍<a href="http://developer.android.com/reference/android/os/AsyncTask.html" target="_blank" rel="external">AsyncTask</a>的使用方法与风险<br><a href="https://www.youtube.com/watch?v=jtlRNNhane0&amp;index=67&amp;list=PLWz5rJ2EKKc9CBxr3BVjPTPoDPLdPIFCE" target="_blank" rel="external">link</a></p>
</blockquote>
<iframe width="560" height="315" src="https://www.youtube.com/embed/jtlRNNhane0?list=PLWz5rJ2EKKc9CBxr3BVjPTPoDPLdPIFCE" frameborder="0" allowfullscreen></iframe>

<hr>
<a id="more"></a>
<h4 id="AsyncTask-Basics"><a href="#AsyncTask-Basics" class="headerlink" title="AsyncTask Basics"></a>AsyncTask Basics</h4><p><a href="http://developer.android.com/reference/android/os/AsyncTask.html" target="_blank" rel="external">AsyncTask</a>是一把双刃剑，用的好了无往不利，用得不好则伤人伤己。</p>
<p>考虑下面这种场景，有一个非常耗时的操作需要进行，我们在<code>UI Thread</code>之外启动了一个<code>Worker Thread</code>，当<code>Worker Thread</code>完成它的工作时，会把计算结果返回给<code>UI Thread</code>。</p>
<p><img src="/img/160223_app_s5ep4/worker_thread.png" alt=""></p>
<p>由于这种应用场景太常见了，Android为我们提供了<code>AsyncTask</code>这一机制。<code>AsyncTask</code>有三个重要的函数。</p>
<ul>
<li>onPreExecute()，在<code>UI Thread</code>中执行，准备Task</li>
<li>doInBackground()，在<code>Worker Thread</code>中执行复杂的任务</li>
<li>onPostExecute()，在<code>UI Thread</code>中执行，处理任务执行结果</li>
</ul>
<p><img src="/img/160223_app_s5ep4/async_task_func.png" alt=""></p>
<hr>
<h4 id="特别说明！onPreExecute并不保证在UI线程中执行！"><a href="#特别说明！onPreExecute并不保证在UI线程中执行！" class="headerlink" title="特别说明！onPreExecute并不保证在UI线程中执行！"></a>特别说明！<code>onPreExecute</code>并不保证在UI线程中执行！</h4><p>虽然<a href="http://developer.android.com/reference/android/os/AsyncTask.html" target="_blank" rel="external">官方API文档</a>中的说明写到<code>AsyncTask</code>“必须在UI线程中执行”，但Framework底层实现中并没有保证这一机制</p>
<blockquote>
<p>The AsyncTask class must be loaded on the UI thread. This is done automatically as of JELLY_BEAN.</p>
</blockquote>
<p>换句话说，“保证<code>onPreExecute()</code>在UI线程中执行”是一个编程规范，而并非强制要求。相比之下，<code>onPostExecue()</code>一定是在UI线程中执行的，因为它是用的是mainLooper。</p>
<p>AsyncTask.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">   <span class="function"><span class="keyword">private</span> Result <span class="title">postResult</span><span class="params">(Result result)</span> </span>&#123;</span><br><span class="line">       <span class="meta">@SuppressWarnings</span>(<span class="string">"unchecked"</span>)</span><br><span class="line">       Message message = getHandler().obtainMessage(MESSAGE_POST_RESULT,</span><br><span class="line">               <span class="keyword">new</span> AsyncTaskResult&lt;Result&gt;(<span class="keyword">this</span>, result));</span><br><span class="line">       message.sendToTarget();</span><br><span class="line">       <span class="keyword">return</span> result;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> Handler <span class="title">getHandler</span><span class="params">()</span> </span>&#123;</span><br><span class="line">       <span class="keyword">synchronized</span> (AsyncTask.class) &#123;</span><br><span class="line">           <span class="keyword">if</span> (sHandler == <span class="keyword">null</span>) &#123;</span><br><span class="line">               sHandler = <span class="keyword">new</span> InternalHandler();</span><br><span class="line">           &#125;</span><br><span class="line">           <span class="keyword">return</span> sHandler;</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">InternalHandler</span> <span class="keyword">extends</span> <span class="title">Handler</span> </span>&#123;</span><br><span class="line">       <span class="function"><span class="keyword">public</span> <span class="title">InternalHandler</span><span class="params">()</span> </span>&#123;</span><br><span class="line">           <span class="keyword">super</span>(Looper.getMainLooper());</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="meta">@SuppressWarnings</span>(&#123;<span class="string">"unchecked"</span>, <span class="string">"RawUseOfParameterizedType"</span>&#125;)</span><br><span class="line">       <span class="meta">@Override</span></span><br><span class="line">       <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleMessage</span><span class="params">(Message msg)</span> </span>&#123;</span><br><span class="line">           AsyncTaskResult&lt;?&gt; result = (AsyncTaskResult&lt;?&gt;) msg.obj;</span><br><span class="line">           <span class="keyword">switch</span> (msg.what) &#123;</span><br><span class="line">               <span class="keyword">case</span> MESSAGE_POST_RESULT:</span><br><span class="line">                   <span class="comment">// There is only one result</span></span><br><span class="line">                   result.mTask.finish(result.mData[<span class="number">0</span>]);</span><br><span class="line">                   <span class="keyword">break</span>;</span><br><span class="line">               <span class="keyword">case</span> MESSAGE_POST_PROGRESS:</span><br><span class="line">                   result.mTask.onProgressUpdate(result.mData);</span><br><span class="line">                   <span class="keyword">break</span>;</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<p>关于上面这一点，可以参考这个例子。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String TAG = <span class="string">"mainactivity"</span>;</span><br><span class="line"></span><br><span class="line">    View titleView;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line">        initViews();</span><br><span class="line">        <span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                MyAsyncTask task = <span class="keyword">new</span> MyAsyncTask();</span><br><span class="line">                task.execute();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;).start();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initViews</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        titleView = findViewById(R.id.title);</span><br><span class="line">        titleView.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;</span><br><span class="line">                toast(<span class="string">"Hello World!"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">toast</span><span class="params">(String s)</span> </span>&#123;</span><br><span class="line">        Toast.makeText(<span class="keyword">this</span>, s, Toast.LENGTH_SHORT).show();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">MyAsyncTask</span> <span class="keyword">extends</span> <span class="title">AsyncTask</span> </span>&#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onPreExecute</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            checkRunningInMainThread(<span class="string">"onPreExecute"</span>);</span><br><span class="line">            <span class="keyword">super</span>.onPreExecute();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onProgressUpdate</span><span class="params">(Object[] values)</span> </span>&#123;</span><br><span class="line">            checkRunningInMainThread(<span class="string">"onProgressUpdate"</span>);</span><br><span class="line">            <span class="keyword">super</span>.onProgressUpdate(values);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onPostExecute</span><span class="params">(Object o)</span> </span>&#123;</span><br><span class="line">            checkRunningInMainThread(<span class="string">"onPostExecute"</span>);</span><br><span class="line">            <span class="keyword">super</span>.onPostExecute(o);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">protected</span> Object <span class="title">doInBackground</span><span class="params">(Object[] params)</span> </span>&#123;</span><br><span class="line">            checkRunningInMainThread(<span class="string">"doInBackGround"</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">checkRunningInMainThread</span><span class="params">(String methodName)</span> </span>&#123;</span><br><span class="line">        Log.d(TAG, methodName + <span class="string">" is running in UI Thread? "</span> + (Looper.myLooper() != <span class="keyword">null</span> &amp;&amp; Looper.getMainLooper() == Looper.myLooper()));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>例子中有一些无关代码（titleView），不过不影响阅读。</p>
<p>日志输出如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">02-29 20:29:06.440 13212-13239/com.leili.geeker D/mainactivity: onPreExecute is running in UI Thread? false</span><br><span class="line">02-29 20:29:06.443 13212-13241/com.leili.geeker D/mainactivity: doInBackGround is running in UI Thread? false</span><br><span class="line">02-29 20:29:06.850 13212-13212/com.leili.geeker D/mainactivity: onPostExecute is running in UI Thread? true</span><br></pre></td></tr></table></figure>
<p>印证了<code>onPreExecute()</code>并不保证在UI线程中执行。</p>
<hr>
<h4 id="AsyncTask-May-Get-You-Into-A-Trouble"><a href="#AsyncTask-May-Get-You-Into-A-Trouble" class="headerlink" title="AsyncTask May Get You Into A Trouble"></a>AsyncTask May Get You Into A Trouble</h4><p>有了上面三个函数，似乎AsyncTask用起来并没有什么困难。然而，如果使用不当，AsyncTask会产生很多匪夷所思的问题。</p>
<p>首先，AsyncTask处理的所有Task，都是放在同一个队列中依次进行的。这意味着，如果前面的Task相当耗时，会使得它后面的Task在很久之后才得以执行。在你处理long running task时应给予高度关注。</p>
<p><img src="/img/160223_app_s5ep4/serial.png" alt=""></p>
<p>实际上，AsyncTask提供了一个用来并行执行Task的方法<code>executeOnExecutor</code>，然而光头哥建议，当你足够理解这个方法时，你就会觉得还是不用为好。</p>
<p><img src="/img/160223_app_s5ep4/execute_on_executor.png" alt=""></p>
<hr>
<h4 id="AsyncTask-Canceling"><a href="#AsyncTask-Canceling" class="headerlink" title="AsyncTask Canceling"></a>AsyncTask Canceling</h4><p>AsyncTask在执行之前／执行过程中，是可以被Cancel掉的。参数<code>mayInterruptIfRunning</code>决定了是否允许在执行过程中被中断。如果一项任务执行了<code>cacel</code>方法，那么在<code>doInBackground</code>后被调起的将不再是<code>onPostExecute</code>，而是<code>onCancel</code>，同样是在<code>UI Thread</code>中进行。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span><br><span class="line"> * Attempts to cancel execution of this task. This attempt will fail if the task has already completed, already been cancelled, or could not be cancelled for some other reason. If successful, and this task has not started when cancel is called, this task should never run. If the task has already started, then the mayInterruptIfRunning parameter determines whether the thread executing this task should be interrupted in an attempt to stop the task.</span><br><span class="line"> * Calling this method will result in onCancelled(Object) being invoked on the UI thread after doInBackground(Object[]) returns. Calling this method guarantees that onPostExecute(Object) is never invoked. After invoking this method, you should check the value returned by isCancelled() periodically from doInBackground(Object[]) to finish the task as early as possible.</span><br><span class="line"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">boolean</span> <span class="title">cancel</span> <span class="params">(<span class="keyword">boolean</span> mayInterruptIfRunning)</span></span>;</span><br></pre></td></tr></table></figure>
<p>如果你的Task在设计时，考虑了cancel的情况，那么你还需要额外做两件事。</p>
<ol>
<li>Check a “canceled” flag regularly</li>
<li>Report work results invalid</li>
</ol>
<p>对于<code>1</code>，如下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">doInBackground(..) &#123;</span><br><span class="line">	<span class="comment">// Doing some stuff</span></span><br><span class="line">	<span class="keyword">if</span> (isCanceled()) &#123;..&#125; <span class="comment">// Oh noez, we done, clean up</span></span><br><span class="line">	<span class="keyword">for</span> (i &lt; obj.length)</span><br><span class="line">		<span class="keyword">if</span> (isCanceled()) &#123;..&#125; <span class="comment">// Oh noez, we done, clean up</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>对于<code>2</code>，当我们知道被cancel的task会调用<code>onCancel</code>方法时，可以在<code>onCancel</code>中做一些诸如更新UI、清理内存的事情。</p>
<p><img src="/img/160223_app_s5ep4/on_cancel.png" alt=""></p>
<hr>
<h3 id="Ending"><a href="#Ending" class="headerlink" title="===Ending==="></a><em>===Ending===</em></h3><hr>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://lilei.work/2016/02/23/Android-Performance-Patterns-s5ep4-Good-AsyncTask-Hunting/" data-id="cisvk1ml5000q1zsuccrgi3ns" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android-Performance-Patterns/">Android Performance Patterns</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/技术流/">技术流</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2016/02/23/Hello-TangYuan/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          你好哇，汤圆儿！
        
      </div>
    </a>
  
  
    <a href="/2016/02/23/Android-Performance-Patterns-s5ep3-Memory-And-Threading/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Android Performance Patterns - s5ep3 Memory &amp; Threading</div>
    </a>
  
</nav>

  
</article>


 <section id="comments">
   <!-- 多说评论框 start -->
   <div class="ds-thread" data-thread-key="post-Android-Performance-Patterns-s5ep4-Good-AsyncTask-Hunting" data-title="Android Performance Patterns - s5ep4 Good AsyncTask Hunting" data-url="http://lilei.work/2016/02/23/Android-Performance-Patterns-s5ep4-Good-AsyncTask-Hunting/"></div>
   <!-- 多说评论框 end -->
   <!-- 多说公共JS代码 start (一个网页只需插入一次) -->
   <script type="text/javascript">
   var duoshuoQuery = {short_name:'lileiwork'};
     (function() {
       var ds = document.createElement('script');
       ds.type = 'text/javascript';ds.async = true;
       ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
       ds.charset = 'UTF-8';
       (document.getElementsByTagName('head')[0] 
        || document.getElementsByTagName('body')[0]).appendChild(ds);
     })();
     </script>
   <!-- 多说公共JS代码 end -->
 </section>
 </section>
        
          <aside id="sidebar">
  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Android-Performance-Patterns/">Android Performance Patterns</a><span class="tag-list-count">20</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Backend/">Backend</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/大保健/">大保健</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/工作效率/">工作效率</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/技术流/">技术流</a><span class="tag-list-count">33</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/槑/">槑</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/自动化测试/">自动化测试</a><span class="tag-list-count">2</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/09/">September 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/06/">June 2016</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/">May 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">April 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">March 2016</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/02/">February 2016</a><span class="archive-list-count">15</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/01/">January 2016</a><span class="archive-list-count">6</span></li></ul>
    </div>
  </div>

  
    <div class="widget-wrap">
	<h3 class="widget-title">Links</h3>
	<div class="widget">
		<ul class="entry">
		<li><a href="http://www.dcharm.com" title="dcharm">杂七杂八by王强 - 数据分析</a></li>
		<li><a href="http://www.lightskystreet.com" title="lightSky">lightSky's Blog</a></li>
		<li><a href="http://androooid.github.io/index.html" title="Android小伙伴的Gitbook">Android小伙伴的Gitbook</a></li>
		</ul>
	</div>
</div>
  
    <div class="widget-wrap">
	<h3 class="widget-title">Recent Comments</h3>
	<div class="widget">
		<ul class="ds-recent-comments" data-num-items="5" data-show-avatars="0" data-show-time="1" data-show-title="1" data-show-admin="1" data-excerpt-length="70"></ul>
	</div>
</div>

<!--多说js加载开始，一个页面只需要加载一次 -->
<script type="text/javascript">
if(typeof duoshuoQuery === 'undefined') {
	  var duoshuoQuery = {short_name:"lileiwork"};
	  (function() {
	    var ds = document.createElement('script');
	    ds.type = 'text/javascript';ds.async = true;
	    ds.src = 'http://static.duoshuo.com/embed.js';
	    ds.charset = 'UTF-8';
	    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ds);
	  })();
  }
</script>
  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2016 Li Lei<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>